<!DOCTYPE html>
<html>
  <head>

    <title>Fractal Viewer</title>
    <meta charset="UTF-8">

    <!-- Responsible for keeping canvas aligned on page -->
    <link rel="stylesheet" href="style.css">

  </head>
  <body>

    <!-- Side menu -->
    <div class="menu">
      <form id="menuform">
        <label for="fractal">Fractal Type</label>
        <select name="fractal">
          <option>Mandelbrot</option>
        </select>
        <label for="colorscheme">Color Scheme</label>
        <select name="colorscheme">
          <option>Grayscale</option>
          <option>Blackbody</option>
        </select>
      </form>
    </div>

    <!-- Main area to draw fractals -->
    <canvas id="display"></canvas>

    <!-- Pulls in the rendering engine -->
    <script src="engine.js"></script>
    <script src="driver.js"></script>

    <!-- Connects user interactions to various functions of the Driver -->
    <script>

    /*
     * Set up Engine and Driver and connect
     * events to various Driver functions
     */

    Engine().then(function (engine) {

        const menu = document.getElementById('menuform');
        const display = document.getElementById('display');
        const driver = new Driver(display, engine);

        // Refresh whenever the window is resized
        window.onresize = function () {
            driver.update();
        };

        // Capture click events
        display.onclick = function (mouseEvent) {
            mouseEvent.preventDefault();
            if (mouseEvent.x < 100 || mouseEvent.x > (display.width - 100) ||
                mouseEvent.y < 100 || mouseEvent.y > (display.height - 100)) {
                // Clicking near the border means zoom out
                driver.zoomOut();
            } else {
                // Otherwise, zoom in on the clicked point
                driver.zoomIn(mouseEvent.x, mouseEvent.y);
            }
        };

        // Refresh the screen when the sidebar menu is used
        menu.onchange = function () {

            switch (menu.fractal.value) {
            case 'Mandelbrot':
                driver.setFractalMandelbrot();
                break;
            }

            switch (menu.colorscheme.value) {
            case 'Grayscale':
                driver.setColorGrayscale();
                break;
            case 'Blackbody':
                driver.setColorBlackbody();
                break;
            }

            driver.update();
        };

        // Once everything is loaded, render the initial view
        driver.update();
    });

    </script>

  </body>
</html>
